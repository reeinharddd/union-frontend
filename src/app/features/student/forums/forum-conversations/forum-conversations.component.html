<!-- Modal de reporte -->
<div
  *ngIf="mostrarModalReporte"
  class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"
>
  <div class="w-full max-w-md rounded-lg bg-white p-6 shadow-lg">
    <h2 class="mb-2 text-lg font-semibold">Reportar comentario</h2>
    <p class="mb-2 text-sm text-gray-700">Por favor, describe el motivo del reporte:</p>
    <textarea
      [(ngModel)]="motivoReporte"
      rows="4"
      class="mb-4 w-full rounded border p-2"
      placeholder="Motivo del reporte..."
    ></textarea>
    <div class="flex justify-end gap-2">
      <button (click)="cerrarModalReporte()" class="rounded bg-gray-200 px-4 py-1">Cancelar</button>
      <button (click)="enviarReporteComentario()" class="rounded bg-red-500 px-4 py-1 text-black">
        Enviar reporte
      </button>
    </div>
  </div>
</div>
<div class="max-w-8xl mx-auto space-y-6 p-4">
  <!-- Encabezado del foro -->
  <div class="flex items-center gap-2 text-sm text-gray-600">
    <button class="text-xl" (click)="goBack()">←</button>
    <span class="font-semibold">{{ foroNombre || 'Comunidad/Foro' }}</span>
  </div>

  <!-- Título del tema -->
  <ng-container *ngIf="hiloTitulo || hiloContenido; else cargandoHilo">
    <h1 class="text-2xl font-bold">{{ hiloTitulo }}</h1>
    <!-- Contenido principal -->
    <div class="leading-relaxed text-gray-700">
      {{ hiloContenido }}
    </div>
  </ng-container>
  <ng-template #cargandoHilo>
    <h1 class="text-2xl font-bold text-gray-400">Cargando título...</h1>
    <div class="leading-relaxed text-gray-400">Cargando contenido...</div>
  </ng-template>

  <!-- Votaciones principales -->
  <!-- <div class="flex items-center gap-2">
    <button class="bg-orange-100 text-orange-600 px-2 py-1 rounded text-sm">⬆️ 11</button>
    <button class="bg-orange-100 text-orange-600 px-2 py-1 rounded text-sm">⬇️ 11</button>
  </div> -->

  <!-- Caja para responder -->
  <div>
    <textarea
      class="mt-4 w-full rounded-md border p-2"
      rows="4"
      placeholder="Escribe tu respuesta..."
      [(ngModel)]="nuevaRespuesta"
      [disabled]="enviando"
    ></textarea>
    <div class="mt-2 flex justify-end gap-2">
      <button
        class="rounded-md bg-gray-200 px-4 py-1 text-sm"
        (click)="enviarRespuesta()"
        [disabled]="enviando || !nuevaRespuesta.trim()"
      >
        {{ enviando ? 'Enviando...' : 'Comentar' }}
      </button>
    </div>
  </div>

  <!-- Respuestas -->
  <div class="space-y-4 border-t pt-4">
    <div
      *ngFor="let respuesta of respuestas"
      class="rounded-xl border border-white/40 bg-white/30 p-4 shadow-sm"
    >
      <div class="mb-1 flex items-center gap-2 text-xs text-gray-700">
        <span class="text-orange-700 font-semibold">
          {{
            respuesta.autor_nombre && respuesta.autor_nombre.length < 50
              ? respuesta.autor_nombre
              : respuesta.autor_id || 'Usuario'
          }}
        </span>
        <span>•</span>
        <span class="text-gray-500">{{ respuesta.creado_en | date: 'mediumDate' }}</span>
        <button
          *ngIf="!esMiComentario(respuesta)"
          class="ml-auto px-2 py-1 text-xs text-red-500 hover:underline"
          title="Reportar comentario"
          (click)="reportarComentario(respuesta)"
        >
          Reportar
        </button>
      </div>
      <<<<<<< HEAD
      <div class="text-sm leading-relaxed text-gray-800">
        {{ respuesta.contenido }}
      </div>
      =======
      <div class="text-sm leading-relaxed text-gray-800">{{ respuesta.contenido }}</div>
      >>>>>>> alma
    </div>
    <div *ngIf="respuestas.length === 0" class="text-sm text-gray-500">No hay respuestas aún.</div>
  </div>
</div>
