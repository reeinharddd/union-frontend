<div class="mx-auto max-w-6xl p-6">
  <h2 class="mb-6 text-center text-2xl font-bold text-gray-800">Lista de Oportunidades</h2>
  <!-- Mensajes de estado -->
  <div *ngIf="mensajeExito" class="mb-4 rounded bg-green-100 p-4 text-green-700 shadow">
    {{ mensajeExito }}
  </div>
  <div *ngIf="mensajeError" class="mb-4 rounded bg-red-100 p-4 text-red-700 shadow">
    {{ mensajeError }}
  </div>

  <!-- Filtro por tipo de oportunidad -->
  <div class="mb-6 flex justify-end">
    <select
      [(ngModel)]="filtroTipo"
      (change)="filtrarPorTipo()"
      class="focus:border-orange-500 focus:ring-orange-500 rounded-md border border-gray-300 px-4 py-2 text-sm text-gray-700 shadow-sm focus:outline-none"
    >
      <option value="">Todos</option>
      <option value="2">Académico</option>
      <option value="1">Laboral</option>
    </select>
  </div>

  <!-- Cards de oportunidades -->
  <div class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2">
    <div
      *ngFor="let oportunidad of oportunidadesFiltradas"
      class="rounded-lg border border-gray-200 bg-white p-6 shadow transition-shadow hover:shadow-md"
    >
      <h3 class="mb-2 text-xl font-semibold text-gray-800">{{ oportunidad.titulo }}</h3>
      <p class="mb-1 text-sm text-gray-600">
        <strong>Modalidad:</strong> {{ modalidadesMap[oportunidad.modality_id] || 'N/A' }}
      </p>
      <p class="mb-1 text-sm text-gray-600">
        <strong>Empresa:</strong> {{ oportunidad.empresa || 'N/A' }}
      </p>
      <p class="mb-1 text-sm text-gray-600">
        <strong>Requisitos:</strong> {{ oportunidad.requisitos || 'N/A' }}
      </p>
      <p class="mb-1 text-sm text-gray-600">
        <strong>Beneficios:</strong> {{ oportunidad.beneficios || 'N/A' }}
      </p>
      <p class="mb-1 text-sm text-gray-600">
        <strong>Fecha Límite:</strong> {{ oportunidad.fecha_limite || 'N/A' }}
      </p>

      <button
        *ngIf="!postulacionesRealizadas.includes(oportunidad.id); else yaPostulado"
        class="flex w-full transform justify-center rounded-xl border border-transparent bg-primary px-4 py-3 text-lg font-medium text-white shadow-hover transition-all duration-200 hover:-translate-y-1 hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
        (click)="postularse(oportunidad.id)"
      >
        Postularse
      </button>

      <ng-template #yaPostulado>
        <p class="mt-4 text-center font-semibold text-green-700">✅ Ya estás postulado</p>
      </ng-template>
    </div>
  </div>

  <div *ngIf="oportunidadesFiltradas.length === 0" class="mt-6 text-center text-gray-600">
    No hay oportunidades disponibles con este filtro.
  </div>
</div>
