<!-- Estado de carga -->
<div *ngIf="loading" class="p-4 text-center">
  <p class="text-gray-600">Cargando proyecto...</p>
</div>

<!-- Error -->
<div *ngIf="error" class="bg-red-50 text-red-600 rounded-lg p-4 text-center">
  {{ error }}
</div>

<!-- Contenido del proyecto -->
<div *ngIf="project && (project.vista_publica || isProjectOwner) && !loading" class="space-y-6">
  <!-- Encabezado gris con estado -->
  <div class="bg-gray-200 relative rounded-t-xl p-6 shadow-sm">
    <div class="flex items-start justify-between">
      <div class="flex items-center gap-4">
        <div class="h-16 w-16 rounded-full bg-black"></div>
        <div>
          <h1 class="flex items-center gap-2 text-xl font-bold text-black sm:text-2xl">
            {{ project.nombre || 'Nombre completo proyecto' }}
            <span *ngIf="project.destacado" class="text-yellow-400 text-2xl">⭐</span>
          </h1>
          <div class="mt-2">
            <span class="bg-gray-100 text-gray-800 inline-block rounded-full px-3 py-1 text-sm">
              Estado: {{ project.estado_verificacion || 'No especificado' }}
            </span>
          </div>
        </div>
      </div>
      <div class="flex flex-col items-center">
        <div class="h-10 w-10 rounded-full bg-black"></div>
        <span class="text-gray-700 mt-1 text-[10px]">Nombre Univ</span>
      </div>
    </div>

    <!-- Línea negra debajo del encabezado -->
    <div class="mt-4 border-t border-black"></div>
  </div>

  <!-- Descripción -->
  <div class="border-gray-300 rounded-lg border bg-white p-4 shadow-sm">
    <h3 class="text-gray-700 mb-2 font-medium">Descripción</h3>
    <p class="text-gray-700 text-sm">
      {{ project.descripcion || 'Base/picio adatada' }}
    </p>
  </div>

  <!-- Sección de colaboradore-->
  <div class="border-gray-200 rounded-lg border bg-white p-4 shadow-sm">
    <div class="mb-3 flex items-center justify-between">
      <h3 class="text-gray-700 font-medium">Colaboradores</h3>
      <span class="text-gray-500 text-sm">{{ project.colaboradores?.length || 0 }} miembros</span>
    </div>

    <div *ngIf="project.colaboradores?.length > 0" class="grid grid-cols-2 gap-4 sm:grid-cols-3">
      <div
        *ngFor="let colab of project.colaboradores"
        class="hover:bg-gray-50 flex items-center gap-3 rounded p-2"
      >
        <div
          class="bg-blue-100 text-blue-600 flex h-10 w-10 items-center justify-center rounded-full font-medium"
        >
          {{ colab.nombre.charAt(0) }}
        </div>
        <div>
          <div class="text-gray-800 font-medium">{{ colab.nombre }}</div>
          <div class="text-gray-500 text-xs">{{ colab.rol || 'Colaborador' }}</div>
        </div>
      </div>
    </div>

    <div
      *ngIf="!project.colaboradores || project.colaboradores.length === 0"
      class="text-gray-500 py-4 text-center"
    >
      No hay colaboradores aún
    </div>
  </div>

  <!-- Botones de acción (sin cambios) -->
  <div *ngIf="isProjectOwner" class="flex flex-col gap-4 sm:flex-row">
    <button
      (click)="openCollaborationModal()"
      class="flex-1 rounded-xl border border-transparent bg-primary px-4 py-3 text-lg font-medium text-white shadow-md transition hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
    >
      Invitar Colaboradores
    </button>

    <a
      [routerLink]="'/student/projects/' + project.id + '/colab'"
      class="border-blue-600 text-blue-600 hover:bg-blue-50 flex-1 rounded-lg border px-4 py-3 text-center font-medium shadow-sm transition"
    >
      Página Colaborativa
    </a>
  </div>
</div>

<!-- Mensaje para proyectos privados (sin cambios) -->
<div
  *ngIf="project && !project.vista_publica && !isProjectOwner && !loading"
  class="flex min-h-[50vh] items-center justify-center"
>
  <div class="max-w-md rounded-lg border bg-white p-6 text-center shadow">
    <div class="text-red-500 mb-4">
      <svg class="mx-auto h-12 w-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
        />
      </svg>
    </div>
    <h2 class="text-red-600 mb-4 text-xl font-semibold">Acceso Restringido</h2>
    <p class="text-gray-600 mb-4">
      Este proyecto es privado y solo los colaboradores pueden verlo.
    </p>
    <button *ngIf="!currentUserId" class="text-blue-600 hover:underline">Solicitar acceso</button>
  </div>
</div>
